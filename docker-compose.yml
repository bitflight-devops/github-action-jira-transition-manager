version: '3.8'

services:
  jira:
    image: atlassian/jira-software:9.4.0
    container_name: jira-e2e
    ports:
      - '8080:8080'
    environment:
      - ATL_PROXY_NAME=localhost
      - ATL_PROXY_PORT=8080
      - ATL_TOMCAT_PORT=8080
      - JVM_MINIMUM_MEMORY=2048m
      - JVM_MAXIMUM_MEMORY=4096m
      - ATL_AUTOLOGIN_COOKIE_AGE=1209600
    volumes:
      - jira-data:/var/atlassian/application-data/jira
    healthcheck:
      test: ['CMD', 'curl', '-f', 'http://localhost:8080/status']
      interval: 10s
      timeout: 5s
      retries: 30
      start_period: 90s

volumes:
  jira-data:
